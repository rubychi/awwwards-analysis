"use strict";function mobileAndTabletcheck(){var t=!1;return function(e){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0)}(navigator.userAgent||navigator.vendor||window.opera),t}function numberWithCommas(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function capitalizeFirstLetter(t){return t.replace(/\w\S*/g,function(t){return t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()})}function sortBtnClickHandler(){$.isEmptyObject(data)||(curOrder="percentage"===curOrder?"country":"percentage",sort(data[curKey],curOrder))}function navClickHandler(t){if(!$.isEmptyObject(data)){prevNav&&prevNav.removeClass("active");var e=$(t).parent();e.addClass("active"),prevNav=e,curKey=t.innerText.toLowerCase(),curOrder="country",sort(data[curKey],"country"),$("#timestamp").text(timestamp+capitalizeFirstLetter(curKey))}}function analyze(t,e,a,r,n,i,o,s){function l(t){return{country:t.Country,percentage:+t.Percentage,submission:+t.Submission,population:+t.Population}}function c(t,e){function a(){for(var e=i(d3.mouse(this)[0]),a=r(e),s=o(e),l=n(t[s].percentage),d=p/t.length,u=0,v=t.length-1;u<190;)u+=d,v--;g.select(".guideline").transition().duration(50).attr("x1",a).attr("x2",a),g.selectAll("circle").filter(function(t,e){return e===c}).transition().duration(50).style("fill","white").attr("r",3.5),g.selectAll("circle").filter(function(t,e){return e===s}).transition().duration(50).style("fill","#0f747f").attr("r",5),g.selectAll(".x-axis-text").filter(function(t,e){return e===c}).transition().duration(50).style("font-size","10px"),g.selectAll(".x-axis-text").filter(function(t,e){return e===s}).transition().duration(50).style("font-size","12px"),s<=v?(d3.select("#tip").transition().duration(50).style("top",l+m.top+f.top+"px").style("left",a+m.left+f.left+"px"),d3.select("#tipTriangle").style("transform","rotate(45deg)").transition().duration(50).style("bottom",y.bottom).style("left",y.left)):(d3.select("#tip").transition().duration(50).style("top",l+m.top+f.top+"px").style("left",a-m.left+"px"),d3.select("#tipTriangle").style("transform","rotate(-45deg)").transition().duration(50).style("bottom",x.bottom).style("left",x.left)),d3.select("#country").text(t[s].country),d3.select("#percentage").text(t[s].percentage.toFixed(11)),d3.select("#submission").text(t[s].submission),d3.select("#population").text(numberWithCommas(t[s].population)),c=s}p=parseInt(d3.select("#chart").style("width"))-m.left-m.right,u=parseInt(d3.select("#chart").style("height"))-m.top-m.bottom;var r=d3.scalePoint().domain(t.map(function(t){return t.country})).range([0,p]),n=d3.scaleLinear().domain(d3.extent(t,function(t){return t.percentage})).range([u,0]),i=d3.scaleQuantize().domain(r.range()).range(r.domain()),o=d3.scaleBand().domain(t.map(function(t){return t.country})).range([0,t.length]),s=d3.area().x(function(t){return r(t.country)}).y0(u).y1(function(t){return n(t.percentage)}).curve(d3.curveMonotoneX),l=d3.line().x(function(t){return r(t.country)}).y(function(t){return n(t.percentage)}).curve(d3.curveMonotoneX),c=0;e?(g.append("path").data([t]).attr("class","area").attr("d",s).style("fill","url(#gradient)"),g.append("g").attr("class","axis x-axis").attr("transform","translate(0,"+u+")").call(d3.axisBottom(r)).selectAll("text").attr("class","x-axis-text").attr("dx","-0.8em").attr("dy","0.15em").style("transform","rotate(-65deg)").style("text-anchor","end"),g.append("g").attr("class","axis y-axis").call(d3.axisLeft(n)).selectAll("text").attr("class","y-axis-text"),g.select(".y-axis").append("text").attr("transform","rotate(-90)").style("text-anchor","end").attr("y","-70").text("Percentage (%)"),g.select(".y-axis").append("text").attr("id","timestamp").style("text-anchor","end").attr("y","-35").attr("dx","225").text(timestamp+capitalizeFirstLetter(curKey)),g.append("path").datum(t).attr("class","trendline").attr("d",l),g.append("line").attr("class","guideline").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",u),g.selectAll("circle").data(t).enter().append("circle").attr("class","circle").attr("cx",function(t){return r(t.country)}).attr("cy",function(t){return n(t.percentage)}).attr("r",3.5).filter(function(t,e){return 0===e}).style("fill","#0f747f").attr("r",5),g.append("rect").attr("class","overlay").attr("width",p).attr("height",u).attr("opacity",0).on("mousemove",a)):(g.select(".area").data([t]).transition().duration(500).attr("d",s),g.select(".trendline").datum(t).transition().duration(500).attr("d",l),g.selectAll("circle").data(t).exit().remove(),g.selectAll("circle").data(t).enter().append("circle").attr("class","circle").attr("r",3.5),g.selectAll("circle").data(t).style("fill","white").attr("r",3.5).transition().duration(500).attr("cx",function(t){return r(t.country)}).attr("cy",function(t){return n(t.percentage)}).filter(function(t,e){return 0===e}).style("fill","#0f747f").attr("r",5),g.selectAll(".x-axis").transition().duration(500).attr("transform","translate(0,"+u+")").call(d3.axisBottom(r)).selectAll("text").attr("class","x-axis-text").attr("dx","-0.8em").attr("dy","0.15em").style("transform","rotate(-65deg)").style("text-anchor","end"),g.selectAll(".x-axis-text").style("font-size","10px").filter(function(t,e){return 0===e}).style("font-size","12px"),g.selectAll(".y-axis").transition().duration(500).call(d3.axisLeft(n)),g.select(".overlay").attr("width",p).attr("height",u).on("mousemove",a),c=0),g.select(".guideline").transition().duration(500).attr("x1",0).attr("x2",0).attr("y2",u),d3.select("#tip").transition().duration(500).style("top",n(t[0].percentage)+m.top+f.top+"px").style("left",r(t[0].country)+m.left+f.left+"px"),d3.select("#tipTriangle").style("transform","rotate(45deg)").transition().duration(50).style("bottom",y.bottom).style("left",y.left),d3.select("#country").text(t[0].country),d3.select("#percentage").text(t[0].percentage.toFixed(11)),d3.select("#submission").text(t[0].submission),d3.select("#population").text(numberWithCommas(t[0].population))}t&&console.log(t),$("#preloader").addClass("hidden"),$("#tip").removeClass("hidden"),$("#tipTriangle").removeClass("hidden"),timestamp=e[0].Timestamp.replace(/\s\(.+\)/,"")+", ",data.nominees=a.map(l),data["honorable mention"]=r.map(l),data["developer award"]=n.map(l),data["site of the day"]=i.map(l),data["site of the month"]=o.map(l),data["site of the year"]=s.map(l),curKey="nominees";var d=d3.select("svg"),p=null,u=null,m={top:80,right:80,bottom:140,left:100},f={},y={},x={};isMobileOrTablet?(f.top=-65,f.left=11,y.bottom="-33px",y.left="-5px",x.bottom="-33px",x.left="176px"):(f.top=-60,f.left=10,y.bottom="-35px",y.left="-15px",x.bottom="-35px",x.left="173px");var g=d.append("g").attr("transform","translate("+m.left+","+m.top+")"),v=d.append("defs").append("linearGradient").attr("id","gradient").attr("x1","0%").attr("y1","0%").attr("x2","0%").attr("y2","100%").attr("spreadMethod","pad");v.append("stop").attr("offset","0%").attr("stop-color","rgb(36,175,192)").attr("stop-opacity",1),v.append("stop").attr("offset","100%").attr("stop-color","rgb(206,254,226)").attr("stop-opacity",1),$(window).on("resize",function(t){c(data[curKey],!1)}),sort=function(t,e){c(t="country"===e?t.sort(function(t,e){return t.country>e.country?1:t.country<e.country?-1:0}):t.sort(function(t,e){return e.percentage-t.percentage}),!1)},c(data[curKey],!0)}var sort=null,data={},curKey="",curOrder="country",timestamp="",isMobileOrTablet=mobileAndTabletcheck(),prevNav=null;isMobileOrTablet?(prevNav=$("#nav-mobile").children().first(),$("#brand")[0].innerText="Analysis"):prevNav=$("#nav").children().first(),d3.queue().defer(d3.csv,"../data/timestamp.csv").defer(d3.csv,"../data/result (nominees).csv").defer(d3.csv,"../data/result (honorable).csv").defer(d3.csv,"../data/result (developer).csv").defer(d3.csv,"../data/result (sites_of_the_day).csv").defer(d3.csv,"../data/result (sites_of_the_month).csv").defer(d3.csv,"../data/result (sites_of_the_year).csv").await(analyze),$(document).ready(function(){$(".button-collapse").sideNav()});